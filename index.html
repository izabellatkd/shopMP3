<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MP3 Player</title>
<style>
body {
  background: #fff;
  font-family: "Lucida Console", monospace;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

.window {
  background: #f9f0e9;
  border: 3px solid #737373;
  box-shadow: 6px 6px 0px #c8c8c8;
  width: 420px;
  display: flex;
  flex-direction: column;
  position: relative;
}

.titlebar {
  background: #cbe4c2;
  color: #fff;
  padding: 5px 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 14px;
  cursor: move;
}

.screen {
  background: #222;
  color: #fff;
  height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  position: relative;
}

.screen video, .screen img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.controls {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 10px;
  background: #ddd;
}

.controls button {
  background: #f9f0e9;
  color: #333;
  border: 2px solid #ccc;
  padding: 8px 14px;
  margin: 0 5px;
  font-family: monospace;
  cursor: pointer;
}

.controls button#playBtn {
  background: #b8e1e4;
}

.track-title {
  text-align: center;
  font-size: 14px;
  padding: 6px;
  background: #fafafa;
  border-top: 1px solid #ccc;
  border-bottom: 1px solid #ccc;
}

.progress-container, .volume-container {
  display: flex;
  align-items: center;
  padding: 5px 10px;
  background: #eee;
  gap: 8px;
}

input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  height: 6px;
  border-radius: 3px;
  background: #7B7B7B;
  outline: none;
  cursor: pointer;
  flex: 1;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: #b8e1e4;
  border: 2px solid #666;
  cursor: pointer;
}

input[type="range"]::-moz-range-thumb {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: #b8e1e4;
  border: 2px solid #666;
  cursor: pointer;
}

/* Volume slider */
.volume-container input[type="range"] {
  width: 80px;
  margin-left: 5px;
}

/* Waveform */
.waveform {
  display: flex;
  justify-content: center;
  align-items: flex-end;
  height: 40px;
  background: #f9f0e9;
  border-bottom: 1px solid #ccc;
  padding: 4px 0;
}

.bar {
  width: 4px;
  margin: 0 2px;
  background: #7B7B7B;
  height: 10px;
  animation: bounce 2s infinite ease-in-out;
  animation-play-state: paused;
}

/* 21 bars delays */
.bar:nth-child(1){animation-delay:0s;}  .bar:nth-child(2){animation-delay:0.1s;}
.bar:nth-child(3){animation-delay:0.2s;}  .bar:nth-child(4){animation-delay:0.3s;}
.bar:nth-child(5){animation-delay:0.4s;}  .bar:nth-child(6){animation-delay:0.5s;}
.bar:nth-child(7){animation-delay:0.6s;}  .bar:nth-child(8){animation-delay:0.7s;}
.bar:nth-child(9){animation-delay:0.8s;}  .bar:nth-child(10){animation-delay:0.9s;}
.bar:nth-child(11){animation-delay:1s;}   .bar:nth-child(12){animation-delay:1.1s;}
.bar:nth-child(13){animation-delay:1.2s;} .bar:nth-child(14){animation-delay:1.3s;}
.bar:nth-child(15){animation-delay:1.4s;} .bar:nth-child(16){animation-delay:1.5s;}
.bar:nth-child(17){animation-delay:1.6s;} .bar:nth-child(18){animation-delay:1.7s;}
.bar:nth-child(19){animation-delay:1.8s;} .bar:nth-child(20){animation-delay:1.9s;}
.bar:nth-child(21){animation-delay:2s;}

@keyframes bounce{
  0%,100%{height:10px;}
  50%{height:35px;}
}

/* Playlist popup */
.playlist-popup {
  display: none;
  position: absolute;
  top: 60px;
  left: 50%;
  transform: translateX(-50%);
  width: 280px;
  max-height: 200px;
  overflow-y: auto;
  border: 2px solid #000;
  background: #f9f0e9;
  box-shadow: 6px 6px 0px #c8c8c8;
  z-index: 100;
}

.playlist-popup .titlebar {
  background: #cbe4c2;
  color: #fff;
  padding: 4px 10px;
  font-size: 13px;
  cursor: move;
  display: flex;
  justify-content: space-between;
}

.playlist-popup ul {
  list-style: none;
  margin: 0;
  padding: 0;
  font-size: 14px;
}

.playlist-popup li {
  padding: 6px 10px;
  cursor: pointer;
}

.playlist-popup li:hover {
  background: #ddd;
}

.playlist-popup li.active {
  background: #b8e1e4;
  color: #333;
}
</style>
<body>
<div class="window" id="mainWindow">
  <div class="titlebar">
    <span>MP3 Player</span>
    <span>‚ñ¢ ‚úñ</span>
  </div>

  <div class="screen" id="screen">
    <img src="covers/cover1.jpg" alt="Album Art">
  </div>

  <div class="controls">
    <button id="prevBtn">‚èÆ</button>
    <button id="playBtn">‚ñ∂</button>
    <button id="nextBtn">‚è≠</button>
    <button id="videoBtn">üì∫</button>
    <button id="shuffleBtn">‚áÑ</button>
    <button id="repeatBtn">‚Üª</button>
    <button id="playlistToggle">üé∂</button>
  </div>

  <div class="track-title" id="trackTitle">Loading...</div>

  <div class="progress-container">
    <span id="currentTime">0:00</span>
    <input type="range" id="progress" class="progress" value="0" min="0" max="100">
    <span id="duration">0:00</span>
  </div>

  <div class="waveform" id="waveform">
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
    <div class="bar"></div><div class="bar"></div><div class="bar"></div>
  </div>

  <div class="volume-container">
    <label for="volume">Volume: ‚ñÅ‚ñÇ‚ñÉ‚ñÑ‚ñÖ‚ñÜ‚ñá </label>
    <input type="range" id="volume" min="0" max="1" step="0.01" value="1">
  </div>

  <div class="playlist-popup" id="playlistPopup">
    <div class="titlebar">
      <span>Playlist</span>
      <span id="playlistClose">‚úñ</span>
    </div>
    <ul id="playlist"></ul>
  </div>

  <audio id="audio"></audio>
</div>

<script>
const audio = document.getElementById('audio');
const playBtn = document.getElementById('playBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const videoBtn = document.getElementById('videoBtn');
const shuffleBtn = document.getElementById('shuffleBtn');
const repeatBtn = document.getElementById('repeatBtn');
const playlistToggle = document.getElementById('playlistToggle');
const playlistPopup = document.getElementById('playlistPopup');
const playlistClose = document.getElementById('playlistClose');
const playlist = document.getElementById('playlist');
const progress = document.getElementById('progress');
const currentTimeEl = document.getElementById('currentTime');
const durationEl = document.getElementById('duration');
const volume = document.getElementById('volume');
const screen = document.getElementById('screen');
const trackTitle = document.getElementById('trackTitle');
const bars = document.querySelectorAll('.bar');

const tracks = [
  { name: "‚òÜStart!‚òÜ", url: "https://studyplaylist.s3.us-east-2.amazonaws.com/Disc+Channel+-+Wii+Fit+Plus+Soundtrack.mp3", cover: "https://github.com/izabellatkd/Study-MP3/blob/main/wii.gif?raw=true" },
  { name: "‚òÜWii Sports‚òÜ", url: "", cover: "https://github.com/izabellatkd/Study-MP3/blob/main/wii.gif?raw=true" },
  { name: "‚òÜWii Party‚òÜ", url: "", cover: "https://github.com/izabellatkd/Study-MP3/blob/main/wii.gif?raw=true" },
  { name: "‚òÜWii Shop‚òÜ", url: "", cover: "https://github.com/izabellatkd/Study-MP3/blob/main/wii.gif?raw=true" },
  { name: "‚òÜTennis!‚òÜ", url: "", cover: "https://github.com/izabellatkd/Study-MP3/blob/main/wii.gif?raw=true" },
  { name: "‚òÜAnimal Tracking‚òÜ", url: "", cover: "https://github.com/izabellatkd/Study-MP3/blob/main/wii.gif?raw=true" }
];

const videos = [
  "videos/retro1.mp4",
  "videos/retro2.mp4",
  "videos/retro3.mp4"
];

let currentVideoIndex = 0;
let currentIndex = 0;
let isPlaying = false;
let isShuffle = false;
let repeatMode = 0;

// Playlist rendering
function renderPlaylist(){
  playlist.innerHTML='';
  tracks.forEach((track,i)=>{
    const li=document.createElement('li');
    li.textContent=track.name;
    if(i===currentIndex) li.classList.add('active');
    li.onclick=()=>{loadTrack(i); togglePlaylist(false);}
    playlist.appendChild(li);
  });
}

function loadTrack(index){
  currentIndex=index;
  audio.src=tracks[index].url;
  trackTitle.textContent=tracks[index].name;
  screen.innerHTML=`<img src="${tracks[index].cover}" alt="Cover">`;
  audio.play();
  isPlaying=true;
  playBtn.textContent="‚è∏";
  setWaveform(true);
  renderPlaylist();
}

function togglePlay(){
  if(isPlaying){ audio.pause(); playBtn.textContent="‚ñ∂"; setWaveform(false);}
  else{ audio.play(); playBtn.textContent="‚è∏"; setWaveform(true);}
  isPlaying=!isPlaying;
}

function prevTrack(){ loadTrack((currentIndex-1+tracks.length)%tracks.length); }

function nextTrack(){
  if(isShuffle){
    let nextIndex;
    do{ nextIndex=Math.floor(Math.random()*tracks.length); }
    while(nextIndex===currentIndex && tracks.length>1);
    loadTrack(nextIndex);
  } else {
    if(repeatMode===2){ loadTrack(currentIndex); }
    else{
      currentIndex=(currentIndex+1)%tracks.length;
      if(currentIndex===0 && repeatMode===0){ audio.pause(); playBtn.textContent="‚ñ∂"; setWaveform(false); }
      else loadTrack(currentIndex);
    }
  }
}

// Cycle through videos on button click
function changeVideo() { 
  currentVideoIndex = (currentVideoIndex + 1) % videos.length;
  screen.innerHTML = `<video src="${videos[currentVideoIndex]}" autoplay loop muted></video>`;
}

function updateProgress(){
  if(audio.duration){
    progress.value=(audio.currentTime/audio.duration)*100;
    currentTimeEl.textContent=formatTime(audio.currentTime);
    durationEl.textContent=formatTime(audio.duration);
  }
}

function formatTime(seconds){ const mins=Math.floor(seconds/60); const secs=Math.floor(seconds%60); return `${mins}:${secs<10?'0':''}${secs}`; }

progress.addEventListener('input',()=>{ audio.currentTime=(progress.value/100)*audio.duration; });
volume.addEventListener('input',()=>{ audio.volume=volume.value; });
audio.addEventListener('timeupdate',updateProgress);
audio.addEventListener('ended',nextTrack);

playBtn.addEventListener('click',togglePlay);
prevBtn.addEventListener('click',prevTrack);
nextBtn.addEventListener('click',nextTrack);
videoBtn.addEventListener('click',changeVideo);
shuffleBtn.addEventListener('click',()=>{ isShuffle=!isShuffle; shuffleBtn.style.background=isShuffle?"#b8e1e4":"#f9f0e9"; });
repeatBtn.addEventListener('click',()=>{ repeatMode=(repeatMode+1)%3; repeatBtn.style.background=repeatMode===0?"#f9f0e9":"#b8e1e4"; });
playlistToggle.addEventListener('click',()=>togglePlaylist());
playlistClose.addEventListener('click',()=>togglePlaylist(false));

function togglePlaylist(forceClose=null){
  if(forceClose===false) playlistPopup.style.display="none";
  else playlistPopup.style.display=playlistPopup.style.display==="block"?"none":"block";
}

// Waveform animation control
function setWaveform(active){
  bars.forEach(bar=>bar.style.animationPlayState=active?"running":"paused");
}

// Make playlist draggable
const popupTitleBar = playlistPopup.querySelector('.titlebar');
let isDragging = false;
let offsetX, offsetY;

popupTitleBar.addEventListener('mousedown', (e) => {
  isDragging = true;
  const rect = playlistPopup.getBoundingClientRect();
  offsetX = e.clientX - rect.left;
  offsetY = e.clientY - rect.top;
});

document.addEventListener('mousemove', (e) => {
  if (isDragging) {
    playlistPopup.style.left = `${e.clientX - offsetX}px`;
    playlistPopup.style.top = `${e.clientY - offsetY}px`;
  }
});

document.addEventListener('mouseup', () => {
  isDragging = false;
});

// Initialize
renderPlaylist();
loadTrack(0);
changeVideo();
</script>
</body>
</html>
